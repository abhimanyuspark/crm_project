import{u as N,a as k,b as T,r as o,ak as y,z as A,j as s,I as B,C as M,a3 as R,a6 as q,e as I,_ as L,al as U,am as _,p as z}from"./index-Cc8wsajM.js";import{B as O,C as P}from"./buttons-vrdrcQfM.js";import{C as $}from"./container-BlReYI1a.js";import{S as u}from"./select-Dlmx0f32.js";import{R as C}from"./DatePicker-C0a13ijv.js";import{v as G}from"./v4-D8aEg3BZ.js";import"./index-B-zK9Jtd.js";const Z=()=>{const{user:x}=N(e=>e.auth),{users:i,loading:j}=N(e=>e.users),h=k(),f=T(),E=i==null?void 0:i.filter(e=>{var a;return(a=e.role)==null?void 0:a.includes("employee")}),D=i==null?void 0:i.filter(e=>{var a;return(a=e.role)==null?void 0:a.includes("client")}),[r,v]=o.useState(x),[d,g]=o.useState(""),[t,n]=o.useState({id:G(),title:"",start:new Date,end:new Date,description:"",allDay:!1,status:y[0]}),[S,b]=o.useState(!1),[l,m]=o.useState({title:"",employee:"",client:""}),w=e=>{const a={};return["title"].forEach(c=>{(!e[c]||!e[c].trim())&&(a[c]=`${z(c)} field is required.`)}),!r&&!d&&(a.employee="Employee field is required.",a.client="Client field is required."),m(a),!Object.keys(a).length},F=async e=>{if(e.preventDefault(),w(t)){b(!0);try{await L.promise(h(U({userId:(r==null?void 0:r.id)||(d==null?void 0:d.id),event:t})),{loading:"Adding event...",success:s.jsx("span",{children:"Event Added Successfully"}),error:s.jsx("span",{children:"Failed to Add Event"})}),(x==null?void 0:x.id)===(r==null?void 0:r.id)&&await h(_(t)),f(-1,{replace:!0})}catch(a){console.log(a)}}b(!1)};o.useEffect(()=>{h(A(""))},[]);const p=e=>{var a;return s.jsxs("div",{className:"flex items-center gap-3 px-2",children:[e&&s.jsx("img",{src:e==null?void 0:e.profile,className:"w-6 h-6"}),e?e==null?void 0:e.name:"--",((a=e==null?void 0:e.role)==null?void 0:a.includes("admin"))&&s.jsx("span",{className:"text-xs py-[2px] px-1 rounded-sm bg-slate-500 text-white",children:"its you"})]})};return s.jsx("div",{className:"p-6",children:s.jsxs($,{children:[s.jsx("div",{className:"border-b border-slate-300 p-4",children:s.jsx("h2",{className:"text-xl font-bold",children:"Add Event"})}),s.jsxs("form",{onSubmit:F,children:[s.jsxs("div",{className:"p-4 flex gap-6 flex-col",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[s.jsx(B,{label:"Title",name:"title",important:!0,focus:!0,error:l.title,value:t.title,placeholder:"Enter a event title...",onChange:e=>{const{name:a,value:c}=e.target;n({...t,[a]:c}),m(Y=>({...Y,[a]:""}))}}),s.jsxs("div",{className:"flex gap-2 flex-col",children:[s.jsx("label",{className:"text-base",children:"Status"}),s.jsx(u,{options:y,value:t.status,fields:e=>e==null?void 0:e.name,onChange:e=>{n(a=>({...a,status:e}))}})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[s.jsxs("div",{className:"flex gap-2 flex-col",children:[s.jsx("label",{className:"text-base",children:"Start Date"}),s.jsx(C,{value:new Date(t.start),onChange:e=>n(a=>({...a,start:e})),showTimeSelect:!0,dateFormat:"YYYY-MM-dd h:mm:aa"})]}),s.jsxs("div",{className:"flex gap-2 flex-col",children:[s.jsx("label",{className:"text-base",children:"End Date"}),s.jsx(C,{value:new Date(t.end),onChange:e=>n(a=>({...a,end:e})),showTimeSelect:!0,dateFormat:"YYYY-MM-dd h:mm:aa"})]})]}),s.jsx("div",{className:"grid grid-cols-1 gap-8",children:s.jsxs("div",{className:"flex gap-2 flex-col",children:[s.jsx("label",{children:"All Day"}),s.jsx(M,{className:"w-5",checked:t.allDay,onChange:()=>n(e=>({...e,allDay:!t.allDay}))})]})}),l.employee&&l.client&&s.jsxs("div",{className:"border border-red-500 rounded-[4px] p-3 text-red-500 bg-red-100 flex justify-between items-center",children:[s.jsx("p",{className:"text-sm",children:"You have to select either client or employee."}),s.jsx(R,{className:"cursor-pointer",onClick:()=>{m(e=>({...e,client:"",employee:""}))}})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[s.jsxs("div",{className:"flex gap-2 flex-col",children:[s.jsx("label",{className:"text-base",children:"Employees"}),s.jsx(u,{search:!0,className:l.employee&&"border-red-500",loading:j,value:r,options:E,fields:e=>e.name,onChange:e=>{v(e),g(""),m(a=>({...a,employee:"",client:""}))},optiontemplete:p,valuetemplete:p}),l.employee&&s.jsx("p",{className:"text-red-500 text-base",children:l.employee})]}),s.jsxs("div",{className:"flex gap-2 flex-col",children:[s.jsx("label",{className:"text-base",children:"Clients"}),s.jsx(u,{search:!0,className:l.client&&"border-red-500",value:d,loading:j,options:D,onChange:e=>{g(e),v(""),m(a=>({...a,employee:"",client:""}))},fields:e=>e.name,optiontemplete:p,valuetemplete:p,emptylist:!0}),l.client&&s.jsx("p",{className:"text-red-500 text-base",children:l.client})]})]}),s.jsx("div",{className:"pb-4",children:s.jsxs("div",{className:"flex gap-2 flex-col",children:[s.jsx("label",{className:"text-base",children:"Description"}),s.jsx(q,{value:t.description,onChange:e=>n(a=>({...a,description:e}))})]})})]}),s.jsxs("div",{className:"border-t border-slate-300 p-4 flex gap-4",children:[s.jsx(O,{text:"Submit",icon:s.jsx(I,{}),type:"submit",loading:S}),s.jsx(P,{type:"button",text:"Cancel",onClick:()=>f(-1,{replace:!0})})]})]})]})})};export{Z as default};
