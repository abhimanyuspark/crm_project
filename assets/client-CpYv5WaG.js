import{j as e,L as E,r as x,a as f,u as v,b as y,c as b,q as K,F as T,v as B,R as k,T as $,_ as F,U as L,w as _,P as j,x as I,y as P,z as R,B as z,I as G,E as M,G as q,H as C,J as Y,K as H,Q as J}from"./index-BHnb6mpe.js";import{a as Q,B as O}from"./buttons-Doy1lID5.js";import{S as W,a as g}from"./container-8j8RH9CX.js";import{S as w}from"./select-BF6mZdGe.js";import{D as X,F as Z,T as ee}from"./FilterTable-DRh3e7lF.js";import{M as se}from"./menu-RI_SXwDj.js";import"./index-D84uvODd.js";import"./index-Cyql6XeM.js";const te=k[0].initialImage,ae=[{accessorKey:"index",header:"Id",cell:a=>{const t=a.row.index;return e.jsx("span",{children:t+1})},enableSorting:!0,sortingFn:(a,t)=>a.index>t.index?-1:1,sortDescFirst:!1,invertSorting:!0},{accessorKey:"profile",enableSorting:!1,header:()=>"Profile",cell:a=>{const t=a.getValue();return e.jsx("img",{src:t,alt:"profile",loading:"lazy",className:"w-10 aspect-square rounded-full",onError:n=>n.currentTarget.srcset=te})}},{accessorKey:"name",header:()=>"Name",cell:a=>{const t=a.getValue(),{id:n}=a.row.original;return e.jsx("div",{className:"w-44 cursor-pointer",children:e.jsx(E,{to:`/crm_project/clients/${n}`,className:"text-sm hover:underline text-slate-700 font-semibold",children:t})})}},{accessorKey:"email",header:()=>"Email",cell:a=>{const t=a.getValue();return e.jsx("div",{className:"w-52 text-sm",children:t})}},{accessorKey:"date",header:()=>e.jsx("span",{children:"Date"}),cell:a=>{const t=a.getValue(),n=new Date(t);return e.jsx("span",{children:n.toLocaleDateString()})},sortDescFirst:!1},{accessorKey:"age",header:()=>"Age",sortDescFirst:!1,cell:a=>{const t=a.getValue();return t?e.jsx(e.Fragment,{children:t}):"--"}},{accessorKey:"visits",sortDescFirst:!1,header:()=>e.jsx("span",{children:"Visits"}),cell:a=>{const t=a.getValue();return t?e.jsx(e.Fragment,{children:t}):"--"}},{accessorKey:"status",header:"Status",cell:a=>{const t=a.getValue(),{id:n,name:h}=a.row.original,[o,c]=x.useState(t),r=f(),{user:i}=v(l=>l.auth),d=i==null?void 0:i.statusMenu,u=async l=>{if((o==null?void 0:o.name)===(l==null?void 0:l.name))return null;c(l),await r($({id:n,status:l})),await F.promise(r(L({id:n,status:l})),{loading:"Updating...",success:e.jsx("b",{children:`${h} status is Update`}),error:e.jsx("b",{children:`${h} status is not Update`})},{position:"top-right"})},m=l=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{backgroundColor:l==null?void 0:l.color},className:"w-3 h-3 rounded-full"}),e.jsx("span",{children:l==null?void 0:l.name})]});return o?e.jsx(w,{optiontemplete:m,valuetemplete:m,width:"8em",optionswidth:"9em",options:d,value:o,fields:l=>l.name,onChange:l=>{u(l)}}):"--"},sortingFn:(a,t,n)=>a.getValue(n).name>t.getValue(n).name?-1:1,sortDescFirst:!1,invertSorting:!0},{accessorKey:"id",enableSorting:!1,header:()=>"Actions",cell:a=>{const t=f(),n=y(),h=b(),{id:o,name:c}=a.row.original,r=u=>{n(`/crm_project/clients/${u}/edit`,{state:{from:h}})},i=u=>{n(`/crm_project/clients/${u}`,{state:{from:h}})},d=u=>{_.fire({title:"Are you sure?",text:`You want to delete ${c} user!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete!"}).then(async m=>{m.isConfirmed&&(t(j(!0)),await t(I(u)),await t(P(u)),t(j(!1)),F.success(`${c} deleted successfull`,{position:"top-right"}))})};return e.jsxs(se,{children:[e.jsxs("li",{onClick:()=>{r(o)},children:[e.jsx(K,{})," Edit"]}),e.jsxs("li",{onClick:()=>{i(o)},children:[e.jsx(T,{})," View"]}),e.jsxs("li",{onClick:()=>{d(o)},children:[e.jsx(B,{})," Delete"]})]})}}],{followUp:le,status:ne}=H,me=()=>{const{users:a,loading:t}=v(s=>s.users),[n,h]=x.useState(""),[o,c]=x.useState(!1),[r,i]=x.useState({allowFollowUp:{type:"All"},status:{name:"All"},dates:{start:"",end:""}}),d=f(),u=y(),{pathname:m}=b(),l=async s=>{d(j(!0)),await d(J(s)),d(j(!1))},S=()=>{i(s=>({...s,allowFollowUp:{type:"All"},status:{name:"All"},dates:{start:"",end:""}})),c(!1),h(""),l({...r,allowFollowUp:{type:"All"},status:{name:"All"},dates:{start:"",end:""}})},U=s=>{c(!0),i(p=>{const V={...p.dates,...s};return{...p,dates:V}}),l({...r,dates:s})},D=s=>{i(p=>({...p,status:s})),c(!0),l({...r,status:s})},A=s=>{i(p=>({...p,allowFollowUp:s})),c(!0),l({...r,allowFollowUp:s})},N=s=>{h(s),c(s!=="")};return x.useEffect(()=>(d(R("client")),()=>d(z())),[d,m]),e.jsxs(e.Fragment,{children:[e.jsxs(W,{children:[e.jsx(g,{children:e.jsx(X,{value:r.dates,onChange:U})}),e.jsx(g,{children:e.jsx(G,{focus:!0,icon:e.jsx(M,{className:"text-slate-500",size:15}),type:"search",height:"33px",value:n,placeholder:"Search here..",onChange:s=>{var p;N((p=s==null?void 0:s.target)==null?void 0:p.value)}})}),o&&e.jsx(g,{children:e.jsx("div",{className:"px-1",children:e.jsx(Q,{icon:e.jsx(q,{}),onClick:S})})}),e.jsx(g,{children:e.jsx(Z,{label:"Filter Clients",onChangeClear:()=>{i(s=>({...s,allowFollowUp:{type:"All"},status:{name:"All"}})),l({...r,allowFollowUp:{type:"All"},status:{name:"All"}})},children:e.jsxs("div",{className:"p-4 flex gap-4 flex-col",children:[e.jsx(C,{label:"Allow FollowUp",children:e.jsx(w,{options:le,onChange:s=>{A(s)},value:r==null?void 0:r.allowFollowUp,fields:s=>s==null?void 0:s.type})}),e.jsx(C,{label:"Status",children:e.jsx(w,{options:ne,onChange:s=>{D(s)},value:r==null?void 0:r.status,fields:s=>s==null?void 0:s.name})})]})})})]}),e.jsxs("div",{className:"p-6 flex gap-6 flex-col",children:[e.jsx("div",{className:"flex gap-2 items-center justify-between ",children:e.jsx(O,{text:"Add Client",icon:e.jsx(Y,{}),type:"button",onClick:()=>{u("/crm_project/clients/add")}})}),e.jsx("div",{className:"p-2 rounded-md border border-slate-200 bg-white",children:e.jsx(ee,{loading:t,Columns:ae,data:a,globalFilter:n,setGlobalFilter:h})})]})]})};export{me as default};
